name: Fix Gradle Wrapper

on:
  workflow_dispatch:

jobs:
  fix:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
      
    - uses: actions/setup-java@v4
      with:
        java-version: 17
        distribution: temurin
        
    - name: Install Gradle
      run: |
        wget https://services.gradle.org/distributions/gradle-8.2-bin.zip
        unzip gradle-8.2-bin.zip
        export PATH=$PATH:gradle-8.2/bin
        
    - name: Regenerate Gradle Wrapper
      run: |
        rm -f gradlew gradlew.bat
        rm -rf gradle/wrapper/
        gradle-8.2/bin/gradle wrapper --gradle-version 8.2
        
    - name: Test New Wrapper
      run: |
        chmod +x gradlew
        ./gradlew --version
        ./gradlew tasks
        
    - name: Try Build
      run: ./gradlew app:assembleDebug
